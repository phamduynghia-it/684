<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trung Thu h·∫°nh ph√∫c</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: radial-gradient(ellipse at bottom, #0d1b2a, #000);
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: "Poppins", sans-serif;
      color: white;
      text-align: center;
      cursor: pointer;
    }

    #lantern-container {
      position: fixed;
      width: 100%;
      height: 100%;
      overflow: hidden;
      top: 0;
      left: 0;
      pointer-events: none;
    }

    .lantern {
      position: absolute;
      will-change: transform;
    }

    .swing {
      animation: swing 3s ease-in-out infinite alternate;
    }

    @keyframes swing {
      from { transform: rotate(-5deg); }
      to { transform: rotate(5deg); }
    }

    #wish-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 20px;
      padding: 25px 35px;
      color: #fff;
      font-size: 1.3em;
      text-shadow: 0 0 10px #fff;
      backdrop-filter: blur(10px);
      opacity: 0;
      transition: opacity 1.2s ease;
      max-width: 80%;
      text-align: center;
      z-index: 10;
    }

    #wish-popup.show {
      opacity: 1;
    }

    #wish-popup img {
      max-width: 220px;
      border-radius: 15px;
      box-shadow: 0 0 25px rgba(255, 255, 255, 0.4);
    }

    #music-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.15);
      color: #fff;
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      width: 45px;
      height: 45px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 18px;
      cursor: pointer;
      z-index: 20;
      backdrop-filter: blur(5px);
      transition: background 0.3s;
    }

    #music-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }
  </style>
</head>

<body>
  <div id="lantern-container"></div>
  <div id="wish-popup"></div>
  <div id="music-btn">üéµ</div>

  <audio id="bg-music" loop>
    <!-- üîä Thay link n√†y b·∫±ng file nh·∫°c c·ªßa b·∫°n (v√≠ d·ª•: music.mp3 trong th∆∞ m·ª•c g·ªëc) -->
    <source src="music.mp3" type="audio/mpeg" />
  </audio>

  <script>
    const lanternContainer = document.getElementById("lantern-container");
    const wishPopup = document.getElementById("wish-popup");
    const music = document.getElementById("bg-music");
    const musicBtn = document.getElementById("music-btn");

    // ===== M·∫¢NG L·ªúI CH√öC & ·∫¢NH =====
    const wishesText = [
       "Ch√∫c v·ª£ y√™u Trung Thu vui v·∫ª üéë",
            "Ch√∫c v·ª£ lu√¥n m·ªâm c∆∞·ªùi nh∆∞ trƒÉng r·∫±m üåï",
            "Anh y√™u v·ª£ ‚ù§Ô∏è",
            "Trung Thu tr√†n ng·∫≠p ni·ªÅm vui üå∏",
    ];

    // T·∫°o m·∫£ng ·∫£nh t·ª± ƒë·ªông t·ª´ th∆∞ m·ª•c /images
    const wishesImg = [];
    const totalImages = 10; // üëâ ch·ªânh s·ªë ·∫£nh b·∫°n c√≥
    for (let i = 1; i <= totalImages; i++) {
      wishesImg.push(`images/a${i}.jpg`);
    }

    // ===== T·∫†O ƒê√àN TRUNG THU =====
    function createLantern() {
      const lantern = document.createElement("img");
      lantern.src = "https://github.com/Panbap/Trungthu/blob/main/den.png?raw=true";
      lantern.className = "lantern swing";

      const layer = Math.floor(Math.random() * 3) + 1;
      let size = 40, duration = 10000, opacity = 0.8;

      if (layer === 1) {
        size = 20 + Math.random() * 20;
        duration = 14000 + Math.random() * 5000;
        opacity = 0.5;
      } else if (layer === 2) {
        size = 30 + Math.random() * 30;
        duration = 12000 + Math.random() * 4000;
        opacity = 0.7;
      } else {
        size = 40 + Math.random() * 40;
        duration = 10000 + Math.random() * 3000;
        opacity = 0.95;
      }

      lantern.style.width = size + "px";
      lantern.style.left = Math.random() * 90 + "vw";
      lantern.style.bottom = "0px";
      lantern.style.opacity = opacity;

      lanternContainer.appendChild(lantern);

      const drift = Math.random() * 140 - 70;
      const up = 120 + Math.random() * 40;
      lantern.animate(
        [
          { transform: "translate(0,0)", opacity: opacity },
          { transform: `translate(${drift}px, -${up}vh)`, opacity: 0 },
        ],
        { duration: duration, easing: "linear", fill: "forwards" }
      );

      setTimeout(() => lantern.remove(), duration);
    }

    // T·∫°o ƒë√®n bay li√™n t·ª•c
    setInterval(createLantern, 500);

    // ===== HI·ªÜN L·ªúI CH√öC HO·∫∂C ·∫¢NH NG·∫™U NHI√äN =====
    function showRandomWish() {
      wishPopup.classList.remove("show");

      setTimeout(() => {
        const showImage = Math.random() < 0.3;
        wishPopup.innerHTML = "";

        if (showImage && wishesImg.length > 0) {
          const img = document.createElement("img");
          img.src = wishesImg[Math.floor(Math.random() * wishesImg.length)];
          wishPopup.appendChild(img);
        } else {
          wishPopup.textContent = wishesText[Math.floor(Math.random() * wishesText.length)];
        }

        wishPopup.classList.add("show");
      }, 500);
    }

    // Hi·ªán ng·∫´u nhi√™n sau m·ªói v√†i gi√¢y
    setInterval(showRandomWish, 4000);
    showRandomWish();

    // ===== PH√ÅT NH·∫†C KHI NH·∫§N M√ÄN H√åNH =====
    let musicStarted = false;

    document.body.addEventListener("click", () => {
      if (!musicStarted) {
        music.play();
        musicStarted = true;
      }
    });

    // ===== N√öT B·∫¨T/T·∫ÆT NH·∫†C =====
    let musicPlaying = false;
    musicBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      if (music.paused) {
        music.play();
        musicPlaying = true;
        musicBtn.textContent = "üîä";
      } else {
        music.pause();
        musicPlaying = false;
        musicBtn.textContent = "üéµ";
      }
    });
  </script>
</body>
</html>
